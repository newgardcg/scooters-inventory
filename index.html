<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scooters Coffee - Inventory Manager</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            overflow: hidden;
        }

        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
        }

        h1 { font-size: 28px; margin-bottom: 10px; }

        .nav-tabs { display: flex; background: #f8f9fa; border-bottom: 2px solid #dee2e6; overflow-x: auto; }
        .nav-tab { padding: 15px 25px; cursor: pointer; border: none; background: transparent; font-weight: 600; color: #666; transition: all 0.3s; white-space: nowrap; }
        .nav-tab:hover { background: #e9ecef; }
        .nav-tab.active { background: white; color: #667eea; border-bottom: 3px solid #667eea; }
        .content { padding: 30px; }
        .view { display: none; }
        .view.active { display: block; }

        .summary-cards { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 30px; }
        .card { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .card h3 { font-size: 14px; margin-bottom: 10px; opacity: 0.9; }
        .card .value { font-size: 28px; font-weight: bold; }

        .controls { display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap; }
        button { background: #667eea; color: white; border: none; padding: 12px 24px; border-radius: 6px; cursor: pointer; font-size: 14px; font-weight: 600; transition: background 0.3s; }
        button:hover { background: #5568d3; }
        button.secondary { background: #6c757d; }
        button.secondary:hover { background: #5a6268; }
        button.danger { background: #dc3545; }
        button.danger:hover { background: #c82333; }
        button.success { background: #28a745; }
        button.success:hover { background: #218838; }
        button.large { padding: 15px 30px; font-size: 16px; }

        table { width: 100%; border-collapse: collapse; margin-bottom: 20px; font-size: 13px; }
        th { background: #f8f9fa; padding: 10px 8px; text-align: left; font-weight: 600; color: #333; border-bottom: 2px solid #dee2e6; font-size: 12px; }
        td { padding: 10px 8px; border-bottom: 1px solid #dee2e6; }
        tr.low-stock { background: #fff3cd; }
        tr.low-stock td { color: #856404; font-weight: 600; }

        input[type="number"], input[type="text"], input[type="email"], textarea {
            width: 100%; padding: 8px; border: 2px solid #dee2e6; border-radius: 4px; font-size: 14px;
        }

        .status-badge { display: inline-block; padding: 4px 8px; border-radius: 4px; font-size: 11px; font-weight: 600; }
        .status-ok { background: #d4edda; color: #155724; }
        .status-low { background: #fff3cd; color: #856404; }
        .status-critical { background: #f8d7da; color: #721c24; }

        .alert-box { padding: 15px; border-radius: 6px; margin: 20px 0; font-weight: 600; }
        .alert-success { background: #d4edda; color: #155724; border-left: 4px solid #28a745; }
        .alert-warning { background: #fff3cd; color: #856404; border-left: 4px solid #ffc107; }
        .alert-danger { background: #f8d7da; color: #721c24; border-left: 4px solid #dc3545; }
        .item-code { color: #667eea; font-family: monospace; font-size: 11px; }

        @media (max-width: 768px) {
            .content { padding: 15px; }
            table { font-size: 11px; }
            th, td { padding: 6px 4px; }
            .nav-tab { padding: 12px 15px; font-size: 13px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>‚òï Scooters Coffee #2106 - Inventory</h1>
            <div style="opacity: 0.9; margin-top: 5px;">Allen, Texas | Harvest Roasting Prices | <span id="currentDate"></span></div>
        </header>

        <div class="nav-tabs">
            <button class="nav-tab active" onclick="switchView('dashboard')">Dashboard</button>
            <button class="nav-tab" onclick="switchView('dailyCount')">Daily Count</button>
            <button class="nav-tab" onclick="switchView('orderSheet')">Order Sheet</button>
            <button class="nav-tab" onclick="switchView('settings')">Settings</button>
        </div>

        <div class="content">
            <!-- Dashboard -->
            <div id="dashboard" class="view active">
                <div class="summary-cards">
                    <div class="card">
                        <h3>Total Inventory Value</h3>
                        <div class="value">$<span id="totalValue">0</span></div>
                    </div>
                    <div class="card" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                        <h3>Low Stock Items</h3>
                        <div class="value"><span id="lowStockCount">0</span></div>
                    </div>
                    <div class="card" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                        <h3>Items Tracked</h3>
                        <div class="value"><span id="itemCount">0</span></div>
                    </div>
                </div>

                <div id="fridayAlert"></div>

                <div class="controls">
                    <button class="large" onclick="switchView('dailyCount'); startDailyCount();">üìã Start Daily Count</button>
                    <button class="secondary" onclick="switchView('orderSheet')">üìß Order Sheet</button>
                </div>

                <div id="inventoryContainer"></div>
            </div>

            <!-- Daily Count -->
            <div id="dailyCount" class="view">
                <div style="max-width: 600px; margin: 0 auto; text-align: center;">
                    <h2>Daily Inventory Count</h2>
                    <p style="color: #666; margin: 10px 0 20px;">Count each item. Takes 3-5 minutes.</p>
                    <div id="countContent"></div>
                </div>
            </div>

            <!-- Order Sheet -->
            <div id="orderSheet" class="view">
                <h2 style="margin-bottom: 20px;">üìã Weekly Order Sheet</h2>
                <div class="controls">
                    <button onclick="generateOrderSheet()">Generate Order Sheet</button>
                    <button class="success" onclick="emailOrderSheet()">üìß Email Order Sheet</button>
                </div>
                <div id="orderSheetContent"></div>
            </div>

            <!-- Settings -->
            <div id="settings" class="view">
                <h2 style="margin-bottom: 20px;">‚öôÔ∏è Settings</h2>

                <div class="form-group" style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 5px; font-weight: 600;">Store Email:</label>
                    <input type="email" id="storeEmail" value="store2106@gmail.com">
                </div>

                <div class="form-group" style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 5px; font-weight: 600;">Manager Emails (comma-separated):</label>
                    <textarea id="managerEmails" rows="3" style="width: 100%; padding: 8px; border: 2px solid #dee2e6; border-radius: 4px;">newgardcg@gmail.com</textarea>
                </div>

                <button onclick="saveSettings()">üíæ Save Settings</button>

                <div class="alert-box alert-success" style="margin-top: 30px;">
                    <h3 style="margin-bottom: 10px;">üì± Share This App</h3>
                    <p style="margin-bottom: 10px;">URL: <strong>https://newgardcg.github.io/scooters-inventory/</strong></p>
                    <p style="margin-top: 15px; font-size: 14px;">
                        Text this URL to your managers. All prices are from Harvest Roasting invoices!
                    </p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // REAL HARVEST ROASTING INVENTORY - All Prices from Actual Invoices
        let inventory = {
            "Beverages": [
                { name: "Oat Milk 32oz/12ct", itemCode: "100209", unit: "case", cost: 25.50, minLevel: 2, quantity: 0 },
                { name: "Almond Milk 32oz/12ct", itemCode: "100210", unit: "case", cost: 25.50, minLevel: 2, quantity: 0 },
                { name: "Coconut Milk 32oz/12ct", itemCode: "100211", unit: "case", cost: 34.50, minLevel: 1, quantity: 0 },
                { name: "Strawberry Smoothie 6ct", itemCode: "100159", unit: "case", cost: 45.00, minLevel: 1, quantity: 0 },
                { name: "Mango Smoothie 6ct", itemCode: "100160", unit: "case", cost: 41.65, minLevel: 1, quantity: 0 },
                { name: "Strawberry Banana Smoothie 6ct", itemCode: "100182", unit: "case", cost: 45.00, minLevel: 1, quantity: 0 },
                { name: "Red Bull Regular 24ct", itemCode: "100792", unit: "case", cost: 31.90, minLevel: 2, quantity: 0 },
                { name: "Red Bull Tropical 24ct", itemCode: "100793", unit: "case", cost: 31.90, minLevel: 1, quantity: 0 },
                { name: "Red Bull Sugar Free 24ct", itemCode: "100794", unit: "case", cost: 31.90, minLevel: 1, quantity: 0 },
                { name: "Red Bull Iced Sugar Free 24ct", itemCode: "102242", unit: "case", cost: 33.55, minLevel: 1, quantity: 0 },
                { name: "Sparkling Water 12ct", itemCode: "102232", unit: "case", cost: 4.80, minLevel: 2, quantity: 0 },
                { name: "Bottled Water 24ct", itemCode: "100283", unit: "case", cost: 11.50, minLevel: 3, quantity: 0 },
                { name: "Lemonade 12ct", itemCode: "100619", unit: "case", cost: 46.10, minLevel: 1, quantity: 0 },
                { name: "Green Tea 36ct", itemCode: "100233", unit: "case", cost: 32.00, minLevel: 1, quantity: 0 },
                { name: "Sweet Tea 12ct", itemCode: "100801", unit: "case", cost: 35.00, minLevel: 1, quantity: 0 }
            ],
            "Coffee": [
                { name: "Scooters Blend Whole Beans 5lb/2ct", itemCode: "100528", unit: "case", cost: 117.00, minLevel: 1, quantity: 0 },
                { name: "Espresso Whole Beans 5lb/4ct", itemCode: "100578", unit: "case", cost: 235.00, minLevel: 1, quantity: 0 },
                { name: "Dark Roast Whole Beans 2lb/2ct", itemCode: "102275", unit: "case", cost: 47.90, minLevel: 1, quantity: 0 },
                { name: "House Cold Brew 5lb/2ct", itemCode: "100568", unit: "case", cost: 117.00, minLevel: 1, quantity: 0 },
                { name: "French Vanilla Whole Beans 2lb/2ct", itemCode: "102278", unit: "case", cost: 47.90, minLevel: 1, quantity: 0 },
                { name: "Caramelicious Whole Beans 3lb", itemCode: "100560", unit: "each", cost: 35.95, minLevel: 2, quantity: 0 },
                { name: "Scooter Doodle Whole Beans 2lb/2ct", itemCode: "102279", unit: "case", cost: 47.90, minLevel: 1, quantity: 0 },
                { name: "Dark Roast Blend Whole Beans 3lb", itemCode: "100526", unit: "each", cost: 35.95, minLevel: 2, quantity: 0 }
            ],
            "Cups & Lids": [
                { name: "Red Straw 1800ct", itemCode: "100013", unit: "case", cost: 25.00, minLevel: 2, quantity: 0 },
                { name: "XL Cold Cup 32oz/270ct", itemCode: "100169", unit: "case", cost: 70.00, minLevel: 1, quantity: 0 },
                { name: "Large Smiley Cold Cup 24oz/600ct", itemCode: "100082", unit: "case", cost: 125.00, minLevel: 1, quantity: 0 },
                { name: "Medium Smiley Cold Cup 20oz/600ct", itemCode: "101622", unit: "case", cost: 77.00, minLevel: 1, quantity: 0 },
                { name: "Large Smiley Hot Cup 20oz/312ct", itemCode: "100196", unit: "case", cost: 46.75, minLevel: 1, quantity: 0 },
                { name: "Red Lid 1000ct", itemCode: "100193", unit: "case", cost: 35.78, minLevel: 2, quantity: 0 },
                { name: "Sip Lid 1080ct", itemCode: "100281", unit: "case", cost: 44.75, minLevel: 2, quantity: 0 },
                { name: "Flat Lid 1000ct", itemCode: "100357", unit: "case", cost: 34.00, minLevel: 2, quantity: 0 }
            ],
            "Dairy & Cream": [
                { name: "Whipped Cream 12ct/15oz", itemCode: "100515", unit: "case", cost: 45.15, minLevel: 2, quantity: 0 },
                { name: "Heavy Ice Cream Base 0.5gal/9ct", itemCode: "100729", unit: "case", cost: 54.10, minLevel: 1, quantity: 0 }
            ],
            "Syrups & Sauces": [
                { name: "Vanilla Syrup 64oz/4ct", itemCode: "100251", unit: "case", cost: 45.75, minLevel: 2, quantity: 0 },
                { name: "Caramel Sauce 64oz/4ct", itemCode: "100254", unit: "case", cost: 46.75, minLevel: 2, quantity: 0 },
                { name: "Mocha Sauce 64oz/4ct", itemCode: "100252", unit: "case", cost: 43.50, minLevel: 2, quantity: 0 },
                { name: "White Mocha Sauce 64oz/4ct", itemCode: "100255", unit: "case", cost: 46.75, minLevel: 2, quantity: 0 },
                { name: "Chai Syrup 64oz/4ct", itemCode: "100435", unit: "case", cost: 51.93, minLevel: 1, quantity: 0 },
                { name: "Chai Syrup 1L/4ct", itemCode: "102269", unit: "case", cost: 27.45, minLevel: 1, quantity: 0 },
                { name: "Strawberry Syrup 1L/4ct", itemCode: "102090", unit: "case", cost: 31.84, minLevel: 1, quantity: 0 },
                { name: "Salted Caramel Syrup 1L/4ct", itemCode: "102164", unit: "case", cost: 31.84, minLevel: 1, quantity: 0 },
                { name: "Hazelnut Syrup 1L/4ct", itemCode: "100426", unit: "case", cost: 31.84, minLevel: 1, quantity: 0 },
                { name: "Pomegranate Peach Syrup 1L/4ct", itemCode: "102089", unit: "case", cost: 35.84, minLevel: 1, quantity: 0 },
                { name: "Blue Raspberry Syrup 1L/4ct", itemCode: "102091", unit: "case", cost: 35.84, minLevel: 1, quantity: 0 },
                { name: "Honey Syrup 750ml/4ct", itemCode: "102149", unit: "case", cost: 23.25, minLevel: 1, quantity: 0 },
                { name: "Brown Butter Syrup 1L", itemCode: "102155", unit: "each", cost: 8.96, minLevel: 2, quantity: 0 },
                { name: "Banana Bread Syrup 750ml", itemCode: "102202", unit: "each", cost: 6.75, minLevel: 2, quantity: 0 },
                { name: "Honey 2lb", itemCode: "100276", unit: "each", cost: 11.50, minLevel: 2, quantity: 0 },
                { name: "Sugar Free White Mocha 64oz", itemCode: "102180", unit: "each", cost: 16.00, minLevel: 1, quantity: 0 },
                { name: "Sugar Free Hazelnut Syrup 1L", itemCode: "102251", unit: "each", cost: 8.00, minLevel: 1, quantity: 0 },
                { name: "Sugar Free Strawberry Syrup 1L", itemCode: "100780", unit: "each", cost: 7.96, minLevel: 1, quantity: 0 },
                { name: "Sugar Free Caramel Sauce 64oz", itemCode: "101221", unit: "each", cost: 16.00, minLevel: 1, quantity: 0 },
                { name: "Sugar Free Mocha Sauce 64oz", itemCode: "100259", unit: "each", cost: 13.34, minLevel: 1, quantity: 0 },
                { name: "Sugar Free Blue Raspberry 1L", itemCode: "102150", unit: "each", cost: 7.96, minLevel: 1, quantity: 0 },
                { name: "Sugar Free Desert Pear 1L", itemCode: "102244", unit: "each", cost: 7.96, minLevel: 1, quantity: 0 },
                { name: "Sugar Free Coconut 1L", itemCode: "102247", unit: "each", cost: 7.96, minLevel: 1, quantity: 0 },
                { name: "Sugar Free Caramel 1L", itemCode: "102249", unit: "each", cost: 8.00, minLevel: 1, quantity: 0 }
            ],
            "Food": [
                { name: "Everything Bagel Spicy Sausage 24ct", itemCode: "100144", unit: "case", cost: 50.99, minLevel: 1, quantity: 0 },
                { name: "Maple Waffle Sandwich 24ct", itemCode: "100145", unit: "case", cost: 50.99, minLevel: 1, quantity: 0 },
                { name: "Ciabatta Bacon Egg Gouda 24ct", itemCode: "100345", unit: "case", cost: 52.53, minLevel: 1, quantity: 0 },
                { name: "French Toastie Sandwich 24ct", itemCode: "102224", unit: "case", cost: 71.50, minLevel: 1, quantity: 0 },
                { name: "Cinnamon Roll 15ct", itemCode: "100532", unit: "case", cost: 14.25, minLevel: 1, quantity: 0 },
                { name: "Cinnamon Roll Icing 9lb", itemCode: "100154", unit: "each", cost: 38.95, minLevel: 1, quantity: 0 },
                { name: "Mini Blueberry Muffins 90ct", itemCode: "100747", unit: "case", cost: 37.00, minLevel: 1, quantity: 0 },
                { name: "Banana Streusel Muffins 32ct", itemCode: "102215", unit: "case", cost: 45.00, minLevel: 1, quantity: 0 },
                { name: "Oreo Cake Bite 18ct", itemCode: "100520", unit: "case", cost: 22.80, minLevel: 1, quantity: 0 },
                { name: "Red Velvet Cake Bite 18ct", itemCode: "100810", unit: "case", cost: 22.80, minLevel: 1, quantity: 0 },
                { name: "Birthday Cake Bite 18ct", itemCode: "100534", unit: "case", cost: 22.80, minLevel: 1, quantity: 0 },
                { name: "Mini Chocolate Chip Cookie 6lb", itemCode: "102118", unit: "case", cost: 40.00, minLevel: 1, quantity: 0 },
                { name: "Mini Donut 312ct", itemCode: "100284", unit: "case", cost: 34.00, minLevel: 1, quantity: 0 },
                { name: "Burrito Bacon Egg Cheese 36ct", itemCode: "100763", unit: "case", cost: 68.25, minLevel: 1, quantity: 0 },
                { name: "Burrito Sausage Egg Cheese 36ct", itemCode: "100764", unit: "case", cost: 68.25, minLevel: 1, quantity: 0 },
                { name: "Tomato Feta Egg Bites 32ct", itemCode: "100765", unit: "case", cost: 109.45, minLevel: 1, quantity: 0 },
                { name: "Bacon Gouda Egg Bites 32ct", itemCode: "100766", unit: "case", cost: 109.45, minLevel: 1, quantity: 0 },
                { name: "Picante Sauce 200ct", itemCode: "100241", unit: "case", cost: 16.55, minLevel: 1, quantity: 0 }
            ],
            "Toppings": [
                { name: "Matcha 1lb", itemCode: "100436", unit: "each", cost: 20.78, minLevel: 2, quantity: 0 },
                { name: "Protein Powder 5lb", itemCode: "100518", unit: "each", cost: 58.00, minLevel: 1, quantity: 0 },
                { name: "Strawberry Dessert Drizzle 12oz", itemCode: "101950", unit: "each", cost: 4.05, minLevel: 2, quantity: 0 },
                { name: "Cinnamon Dessert Drizzle 12oz", itemCode: "102152", unit: "each", cost: 4.05, minLevel: 2, quantity: 0 },
                { name: "Oreo Cookie Crumbs 12lb", itemCode: "102252", unit: "case", cost: 65.00, minLevel: 1, quantity: 0 }
            ],
            "Supplies": [
                { name: "Scooters Napkins 6000ct", itemCode: "100236", unit: "case", cost: 86.76, minLevel: 1, quantity: 0 },
                { name: "Spring Lid Sticker 7500ct", itemCode: "102281", unit: "each", cost: 10.75, minLevel: 2, quantity: 0 },
                { name: "No Rinse Floor Cleaner 1gal", itemCode: "100046", unit: "each", cost: 7.75, minLevel: 2, quantity: 0 },
                { name: "Franke Milk Cleaner 1L", itemCode: "100062", unit: "each", cost: 20.68, minLevel: 1, quantity: 0 },
                { name: "Franke Cleaning Tablets 100ct", itemCode: "100063", unit: "each", cost: 17.85, minLevel: 1, quantity: 0 },
                { name: "Disinfectant Wipes 160ct", itemCode: "100221", unit: "each", cost: 10.68, minLevel: 2, quantity: 0 },
                { name: "Vinyl Gloves XL 100ct", itemCode: "100375", unit: "each", cost: 8.98, minLevel: 3, quantity: 0 },
                { name: "Hand Soap Refill 1gal", itemCode: "100075", unit: "each", cost: 10.69, minLevel: 2, quantity: 0 }
            ]
        };

        let settings = {
            storeEmail: 'store2106@gmail.com',
            managerEmails: 'newgardcg@gmail.com'
        };

        let countIndex = 0;
        let countItems = [];

        // Load data
        function loadData() {
            const saved = localStorage.getItem('scootersInventory');
            if (saved) {
                const savedData = JSON.parse(saved);
                // Preserve quantities but update prices/codes
                for (const [category, items] of Object.entries(inventory)) {
                    if (savedData[category]) {
                        items.forEach((item, index) => {
                            if (savedData[category][index]) {
                                item.quantity = savedData[category][index].quantity || 0;
                            }
                        });
                    }
                }
            }
            const savedSettings = localStorage.getItem('scootersSettings');
            if (savedSettings) {
                settings = JSON.parse(savedSettings);
                document.getElementById('storeEmail').value = settings.storeEmail || '';
                document.getElementById('managerEmails').value = settings.managerEmails || '';
            }
            updateDisplay();
            checkFriday();
        }

        function saveInventory() {
            localStorage.setItem('scootersInventory', JSON.stringify(inventory));
            updateDisplay();
        }

        function saveSettings() {
            settings.storeEmail = document.getElementById('storeEmail').value;
            settings.managerEmails = document.getElementById('managerEmails').value;
            localStorage.setItem('scootersSettings', JSON.stringify(settings));
            alert('Settings saved!');
        }

        function switchView(viewName) {
            document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
            document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
            document.getElementById(viewName).classList.add('active');
            event.target.classList.add('active');
            if (viewName === 'orderSheet') generateOrderSheet();
        }

        function updateDisplay() {
            const container = document.getElementById('inventoryContainer');
            container.innerHTML = '';
            let totalValue = 0, lowStockCount = 0, itemCount = 0;

            for (const [category, items] of Object.entries(inventory)) {
                itemCount += items.length;
                const section = document.createElement('div');
                section.innerHTML = `<h3 style="background: #f8f9fa; padding: 12px; margin: 20px 0 10px; border-left: 4px solid #667eea;">${category}</h3>`;
                const table = document.createElement('table');
                table.innerHTML = '<thead><tr><th>Item</th><th>Item Code</th><th>Count</th><th>Unit</th><th>Cost</th><th>Value</th><th>Status</th></tr></thead><tbody></tbody>';
                const tbody = table.querySelector('tbody');

                items.forEach((item, index) => {
                    const itemValue = item.quantity * item.cost;
                    totalValue += itemValue;
                    let status = 'OK', statusClass = 'status-ok', rowClass = '';
                    if (item.quantity <= item.minLevel / 2) {
                        status = 'CRITICAL'; statusClass = 'status-critical'; rowClass = 'low-stock'; lowStockCount++;
                    } else if (item.quantity <= item.minLevel) {
                        status = 'LOW'; statusClass = 'status-low'; rowClass = 'low-stock'; lowStockCount++;
                    }

                    const row = document.createElement('tr');
                    row.className = rowClass;
                    row.innerHTML = `
                        <td><strong>${item.name}</strong></td>
                        <td><span class="item-code">${item.itemCode}</span></td>
                        <td><input type="number" value="${item.quantity}" onchange="updateQuantity('${category}', ${index}, this.value)" style="width: 70px; padding: 4px;"></td>
                        <td>${item.unit}</td>
                        <td>$${item.cost.toFixed(2)}</td>
                        <td><strong>$${itemValue.toFixed(2)}</strong></td>
                        <td><span class="status-badge ${statusClass}">${status}</span></td>
                    `;
                    tbody.appendChild(row);
                });

                section.appendChild(table);
                container.appendChild(section);
            }

            document.getElementById('totalValue').textContent = totalValue.toFixed(2);
            document.getElementById('lowStockCount').textContent = lowStockCount;
            document.getElementById('itemCount').textContent = itemCount;
            document.getElementById('currentDate').textContent = new Date().toLocaleDateString('en-US', {
                weekday: 'long', year: 'numeric', month: 'long', day: 'numeric'
            });
        }

        function updateQuantity(category, index, value) {
            inventory[category][index].quantity = parseFloat(value) || 0;
            saveInventory();
        }

        // Daily Count
        function startDailyCount() {
            countItems = [];
            for (const [category, items] of Object.entries(inventory)) {
                items.forEach((item, index) => {
                    countItems.push({ category, index, ...item });
                });
            }
            countIndex = 0;
            showCountItem();
        }

        function showCountItem() {
            const content = document.getElementById('countContent');
            if (countIndex >= countItems.length) {
                finishDailyCount();
                return;
            }

            const item = countItems[countIndex];
            content.innerHTML = `
                <div style="background: #f8f9fa; padding: 40px; border-radius: 12px; margin: 30px 0;">
                    <div style="color: #666; margin-bottom: 20px;">Item ${countIndex + 1} of ${countItems.length}</div>
                    <h2 style="color: #667eea; font-size: 28px; margin-bottom: 10px;">${item.name}</h2>
                    <p style="color: #999; font-size: 14px; margin-bottom: 20px;">Code: ${item.itemCode} | Unit: ${item.unit}</p>
                    <input type="number" id="countInput" style="font-size: 42px; text-align: center; padding: 20px; margin: 20px 0; border: 3px solid #667eea; border-radius: 8px; width: 100%;" placeholder="0" autofocus>
                    <button class="large" style="width: 100%; margin-top: 10px;" onclick="saveCountAndNext()">Next ‚Üí</button>
                </div>
            `;
            document.getElementById('countInput').focus();
            document.getElementById('countInput').addEventListener('keypress', e => {
                if (e.key === 'Enter') saveCountAndNext();
            });
        }

        function saveCountAndNext() {
            const value = parseFloat(document.getElementById('countInput').value) || 0;
            const item = countItems[countIndex];
            inventory[item.category][item.index].quantity = value;
            countIndex++;
            showCountItem();
        }

        function finishDailyCount() {
            saveInventory();
            document.getElementById('countContent').innerHTML = `
                <div class="alert-box alert-success">
                    <h3>‚úì Count Complete!</h3>
                    <p style="margin: 10px 0;">Inventory has been updated and saved.</p>
                    <button class="large" onclick="switchView('dashboard')" style="margin-top: 10px;">Back to Dashboard</button>
                </div>
            `;
        }

        // Order Sheet
        function generateOrderSheet() {
            const content = document.getElementById('orderSheetContent');
            const orderItems = [];

            for (const [category, items] of Object.entries(inventory)) {
                items.forEach(item => {
                    if (item.quantity <= item.minLevel) {
                        const reorderQty = Math.ceil((item.minLevel * 2) - item.quantity);
                        orderItems.push({
                            category, name: item.name, itemCode: item.itemCode, unit: item.unit, current: item.quantity,
                            reorderQty, cost: item.cost, total: reorderQty * item.cost,
                            status: item.quantity <= item.minLevel / 2 ? 'CRITICAL' : 'LOW'
                        });
                    }
                });
            }

            if (orderItems.length === 0) {
                content.innerHTML = '<div class="alert-box alert-success">All items fully stocked!</div>';
                return;
            }

            const totalCost = orderItems.reduce((sum, item) => sum + item.total, 0);
            let html = `<div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin: 20px 0;">
                <h3>Harvest Roasting Order - ${new Date().toLocaleDateString()}</h3>
                <p><strong>Items:</strong> ${orderItems.length} | <strong>Total:</strong> $${totalCost.toFixed(2)}</p>
            </div><table><thead><tr><th>Code</th><th>Item</th><th>Current</th><th>Order Qty</th><th>Unit Cost</th><th>Total</th></tr></thead><tbody>`;

            orderItems.forEach(item => {
                html += `<tr class="${item.status === 'CRITICAL' ? 'low-stock' : ''}">
                    <td><span class="item-code">${item.itemCode}</span></td>
                    <td><strong>${item.name}</strong></td>
                    <td>${item.current}</td>
                    <td><strong>${item.reorderQty} ${item.unit}</strong></td>
                    <td>$${item.cost.toFixed(2)}</td>
                    <td><strong>$${item.total.toFixed(2)}</strong></td>
                </tr>`;
            });

            html += '</tbody></table>';
            content.innerHTML = html;
        }

        function emailOrderSheet() {
            const orderItems = [];
            for (const [category, items] of Object.entries(inventory)) {
                items.forEach(item => {
                    if (item.quantity <= item.minLevel) {
                        const reorderQty = Math.ceil((item.minLevel * 2) - item.quantity);
                        orderItems.push({
                            category, name: item.name, itemCode: item.itemCode, unit: item.unit, current: item.quantity, reorderQty,
                            cost: item.cost, total: reorderQty * item.cost
                        });
                    }
                });
            }

            if (orderItems.length === 0) { alert('No items need ordering!'); return; }

            const totalCost = orderItems.reduce((sum, item) => sum + item.total, 0);
            let emailBody = `SCOOTERS COFFEE #2106 - HARVEST ROASTING ORDER\nDate: ${new Date().toLocaleDateString()}\nAllen, Texas\n\nSUMMARY:\nTotal Items: ${orderItems.length}\nEstimated Cost: $${totalCost.toFixed(2)}\n\nORDER LIST:\n${'='.repeat(70)}\n\n`;

            let currentCategory = '';
            orderItems.forEach(item => {
                if (item.category !== currentCategory) {
                    currentCategory = item.category;
                    emailBody += `\n${currentCategory.toUpperCase()}\n${'-'.repeat(50)}\n`;
                }
                emailBody += `Code: ${item.itemCode} - ${item.name}\n`;
                emailBody += `  Current: ${item.current} | Order: ${item.reorderQty} ${item.unit}\n`;
                emailBody += `  Cost: $${item.cost.toFixed(2)} each = $${item.total.toFixed(2)} total\n\n`;
            });

            emailBody += `\n${'='.repeat(70)}\nTOTAL ORDER COST: $${totalCost.toFixed(2)}`;

            const recipients = [settings.storeEmail, settings.managerEmails].filter(e => e).join(',');
            const mailtoLink = `mailto:${recipients}?subject=${encodeURIComponent('Harvest Roasting Order - ' + new Date().toLocaleDateString())}&body=${encodeURIComponent(emailBody)}`;
            window.location.href = mailtoLink;
        }

        function checkFriday() {
            if (new Date().getDay() === 5) {
                document.getElementById('fridayAlert').innerHTML = `
                    <div class="alert-box alert-success">
                        <h3>üéØ It's Friday! Time to Order</h3>
                        <button onclick="switchView('orderSheet')" style="margin-top: 10px;">Go to Order Sheet ‚Üí</button>
                    </div>
                `;
            }
        }

        window.onload = function() {
            loadData();
        };
    </script>
</body>
</html>